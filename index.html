<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Galería de Imágenes y Audios</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #f5f5f5; }
    form { margin: 2em auto; padding: 1em; background: white; border-radius: 8px; max-width: 400px; }
    .gallery { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin: 2em; }
    .post { width: 200px; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    img { width: 100%; border-radius: 5px; }
    audio { width: 100%; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Sube tu imagen y audio</h1>
  <form id="uploadForm">
    <input type="file" name="image" accept="image/*" required><br><br>
    <input type="file" name="audio" accept="audio/*" required><br><br>
    <button type="submit">Subir</button>
  </form>

  <h2>Galería</h2>
  <div class="gallery" id="gallery"></div>

  <script>
    const form = document.getElementById('uploadForm');
    const gallery = document.getElementById('gallery');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      await fetch('/upload', { method: 'POST', body: formData });
      form.reset();
      loadGallery();
    });

    async function loadGallery() {
      const res = await fetch('/posts');
      const posts = await res.json();
      gallery.innerHTML = '';
      posts.forEach(post => {
        const div = document.createElement('div');
        div.className = 'post';
        div.innerHTML = `
          <img src="/uploads/${post.image}" alt="Imagen">
          <audio controls src="/uploads/${post.audio}"></audio>
        `;
        gallery.appendChild(div);
      });
    }

    loadGallery();
  </script>
</body>
</html>
